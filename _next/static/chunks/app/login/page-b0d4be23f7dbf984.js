(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{9200:function(e,t,n){Promise.resolve().then(n.bind(n,4925))},2914:function(e,t,n){"use strict";n.d(t,{V:function(){return getContenttype},l:function(){return errorCatch}});let getContenttype=()=>({"Content-type":"application/json"}),errorCatch=e=>{var t,n;let s=null==e?void 0:null===(n=e.response)||void 0===n?void 0:null===(t=n.data)||void 0===t?void 0:t.message;return s?"object"==typeof e.response.data.message?s[0]:s:e.message}},5957:function(e,t,n){"use strict";n.d(t,{v:function(){return u}});var s=n(9222),a=n(2914),o=n(5583),i=n(9497);let l={baseURL:"http://89.111.152.225:3500/api",headers:(0,a.V)()},u=s.Z.create(l),c=s.Z.create(l);c.interceptors.request.use(async e=>{let t=(0,o.Hk)();return e.headers&&t&&(e.headers.Authorization="Bearer ".concat(t)),e}),c.interceptors.response.use(e=>e,async e=>{var t;let n=e.config;if(((null==e?void 0:null===(t=e.response)||void 0===t?void 0:t.status)===401||"jwt expired"===(0,a.l)(e)||"jwt must be provided"===(0,a.l)(e))&&e.config&&!e.config._isRetry){n._isRetry=!0;try{return await i.e.getNewTokens(),c.request(n)}catch(e){"jwt expired"===(0,a.l)(e)&&(0,o.Pf)()}}}),t.Z=c},4925:function(e,t,n){"use strict";n.r(t);var s=n(7437),a=n(2664),o=n(328),i=n(7498),l=n(9127),u=n(1300),c=n(1865),d=n(4033),m=n(690);t.default=()=>{var e,t;(0,u.l)();let{push:n}=(0,d.useRouter)(),{login:f}=(0,l.o)(),{errPassword:h}=(0,m.C)(e=>e.user),{register:v,handleSubmit:g,formState:{errors:p},reset:x}=(0,c.cI)({mode:"onChange"});return(0,s.jsx)("section",{className:"flex h-screen mt-5",children:(0,s.jsxs)("form",{onSubmit:g(e=>{f(e),x()}),className:" m-auto",children:[(0,s.jsx)(i.Z,{className:"text-center mb-4",children:"Войти"}),(0,s.jsx)(o.Z,{...v("email",{required:"Почта обязательная",pattern:{value:/\S+@\S+\.\S+/,message:"Только корректная почта"}}),placeholder:"Почта",error:null==p?void 0:null===(e=p.email)||void 0===e?void 0:e.message,className:"mb-3 px-3 border-gray"}),(0,s.jsx)(o.Z,{...v("password",{required:"Пароль обязательно",minLength:{value:6,message:"Не менее 6 символов"}}),placeholder:"Пароль",error:null==p?void 0:null===(t=p.password)||void 0===t?void 0:t.message,className:"mb-3 px-3 border-gray"}),(0,s.jsx)(a.Z,{className:"m-auto",variant:"dark",type:"submit",children:"Войти"}),(0,s.jsxs)("div",{className:"mt-3 text-center",children:[(0,s.jsx)("span",{children:"Еще не зарегестрированы?"}),(0,s.jsx)("button",{type:"button",className:"text-blue text-sm mt-3 font-semibold ml-2",onClick:()=>n("/register"),children:"Регистрация"})]}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("button",{type:"button",className:"text-blue text-sm mt-3 font-semibold",onClick:()=>n("/"),children:"На главную"})}),(0,s.jsx)("div",{className:"text-center mt-3",children:h&&(0,s.jsx)("span",{className:"text-red-600 text-sm font-semibold",children:h})})]})})}},2664:function(e,t,n){"use strict";var s=n(7437),a=n(7042);t.Z=e=>{let{children:t,variant:n,className:o,...i}=e;return(0,s.jsx)("button",{...i,className:(0,a.Z)("rounded-xl px-10 py-2 shadow flex mt-3 hover:shadow-lg duration-300 ease-in-out",{"text-blue bg-white":"light"===n,"text-white bg-fiolet ":"dark"===n},o),children:t})}},328:function(e,t,n){"use strict";var s=n(7437),a=n(2265),o=n(7042),i=n(690);let l=(0,a.forwardRef)((e,t)=>{let{placeholder:n,str:a,error:l,Icon:u,style:c,className:d,type:m="text",...f}=e,{theme:h}=(0,i.C)(e=>e.theme);return(0,s.jsxs)("div",{className:(0,o.Z)("",d),style:c,children:[(0,s.jsxs)("label",{className:" mb-4",children:[(0,s.jsxs)("span",{className:(0,o.Z)("",{"text-block":"white"===h,"text-white":"black"===h}),children:[u&&(0,s.jsx)(u,{className:" mr-3"}),n]}),(0,s.jsx)("input",{placeholder:n,ref:t,type:m,className:(0,o.Z)(" font-semibold border rounded-lg border-gray border-solid placeholder:font-normal outline-none px-6 py-2 w-full focus:border-fiolet transition-all",{"border-red-600":l&&l,"text-block":"white"===h,"text-block ":"black"===h},d),...f})]}),l&&(0,s.jsx)("div",{className:" font-semibold text-red-600 text-sm align-middle",children:l})]})});l.displayName="Field",t.Z=l},7498:function(e,t,n){"use strict";var s=n(7437),a=n(7042);t.Z=e=>{let{children:t,className:n}=e;return(0,s.jsx)("h1",{className:(0,a.Z)("font-semibold text-3x1",n),children:t})}},9127:function(e,t,n){"use strict";n.d(t,{o:function(){return useActions}});var s=n(2265),a=n(690),o=n(7373),i=n(7265),l=n(6549);let u={...i,...l},useActions=()=>{let e=(0,a.T)();return(0,s.useMemo)(()=>(0,o.DE)(u,e),[e])}},2625:function(e,t,n){"use strict";n.d(t,{J:function(){return UseAuth}});var s=n(690);let UseAuth=()=>(0,s.C)(e=>e.user)},1300:function(e,t,n){"use strict";n.d(t,{l:function(){return useAuthRedirect}});var s=n(4033),a=n(2625),o=n(2265);let useAuthRedirect=()=>{let{user:e}=(0,a.J)(),{replace:t}=(0,s.useRouter)();(0,o.useEffect)(()=>{e&&t("/")},[e])}},690:function(e,t,n){"use strict";n.d(t,{C:function(){return o},T:function(){return a}});var s=n(3198);let a=s.I0,o=s.v9},5583:function(e,t,n){"use strict";n.d(t,{Hk:function(){return getAccesToken},Pf:function(){return removeTokensStorage},Zd:function(){return saveToStoraga}});var s=n(1490);let saveTokenStorage=e=>{s.Z.set("accesToken",e.accesToken),s.Z.set("refreshToken",e.refreshToken)},getAccesToken=()=>{let e=s.Z.get("accesToken");return e||null},removeTokensStorage=()=>{s.Z.remove("accesToken"),s.Z.remove("refreshToken"),localStorage.removeItem("user")},saveToStoraga=e=>{saveTokenStorage(e),localStorage.setItem("user",JSON.stringify(e.user))}},9497:function(e,t,n){"use strict";n.d(t,{e:function(){return i}});var s=n(5957),a=n(5583),o=n(1490);let i={async login(e){let t=await (0,s.v)({url:"/auth/login",method:"POST",data:e});return t.data&&((0,a.Zd)(t.data),localStorage.setItem("count","2")),t.data},async register(e){let t=await (0,s.v)({url:"/auth/register",method:"POST",data:e});return t.data&&((0,a.Zd)(t.data),localStorage.setItem("count","2")),t},async getNewTokens(){let e=o.Z.get("refreshToken"),t=await (0,s.v)({url:"/auth/tokens",method:"POST",data:{refreshToken:e}});return t.data.accesToken&&(0,a.Zd)(t.data),t}}},6549:function(e,t,n){"use strict";n.r(t),n.d(t,{addToCart:function(){return o},changeQuantity:function(){return l},removeFromCart:function(){return i},resetCart:function(){return u},setComVis:function(){return d},setVisible:function(){return c}});var s=n(663);let a=(0,s.oM)({name:"cart",initialState:{items:[],visible:!1,comVis:!1},reducers:{addToCart(e,t){e.items.some(e=>{var n,s;return(null===(n=e.product)||void 0===n?void 0:n.id)===(null===(s=t.payload.product)||void 0===s?void 0:s.id)});let n=e.items.some(e=>e.text===t.payload.text);n||e.items.push({...t.payload,id:e.items.length})},removeFromCart(e,t){e.items=e.items.filter(e=>e.text!==t.payload.text)},changeQuantity(e,t){let{slug:n,type:s,text:a}=t.payload,o=e.items.find(e=>e.text===a);o&&("plus"===s?o.quantity&&o.quantity++:o.quantity&&o.quantity--)},resetCart(e){e.items=[]},setVisible(e,t){t.payload.visible?e.visible=!1:e.visible=!0},setComVis(e,t){t.payload.visible?e.visible=!1:e.visible=!0}}});t.default=a.reducer;let{addToCart:o,removeFromCart:i,changeQuantity:l,resetCart:u,setVisible:c,setComVis:d}=a.actions},7265:function(e,t,n){"use strict";n.r(t),n.d(t,{checkAuth:function(){return m},login:function(){return c},logout:function(){return d},register:function(){return u}});var s=n(663),a=n(9497),o=n(5583),i=n(2914),l=n(6549);let u=(0,s.hg)("auth/register",async(e,t)=>{try{let t=await a.e.register(e);return localStorage.setItem("count","2"),t.data}catch(e){return t.rejectWithValue(e)}}),c=(0,s.hg)("auth/login",async(e,t)=>{try{let t=await a.e.login(e);return localStorage.setItem("count","2"),t}catch(e){return t.rejectWithValue(e)}}),d=(0,s.hg)("auth/logout",async()=>{(0,o.Pf)(),(0,l.resetCart)()}),m=(0,s.hg)("auth/check-auth",async(e,t)=>{try{let e=await a.e.getNewTokens();return e.data}catch(e){return"jwt expired"===(0,i.l)(e)&&t.dispatch(d),t.rejectWithValue(e)}})},7042:function(e,t,n){"use strict";t.Z=function(){for(var e,t,n=0,s="";n<arguments.length;)(e=arguments[n++])&&(t=function r(e){var t,n,s="";if("string"==typeof e||"number"==typeof e)s+=e;else if("object"==typeof e){if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=r(e[t]))&&(s&&(s+=" "),s+=n);else for(t in e)e[t]&&(s&&(s+=" "),s+=t)}return s}(e))&&(s&&(s+=" "),s+=t);return s}}},function(e){e.O(0,[83,540,971,864,744],function(){return e(e.s=9200)}),_N_E=e.O()}]);